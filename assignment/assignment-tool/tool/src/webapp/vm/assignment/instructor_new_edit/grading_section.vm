#**
"Grading" Section
This section contains the options for grading this assignment.

Markup note: Markup is defined in "fragments" (due to how Velocity parses, these must be defined first) that
             are applied to a "skeleton". Scroll to the bottom of the file and review the skeleton to get a better
             idea of the structure of this section.

@author plukasew
*#

## ---------- Fragments ---------------

#define($fragment_anonymous)
	<div class="checkbox">
		<label for="$name_CheckAnonymousGrading" #if( !$enableAnonGrading ) class="disabled" #end>
			<input id="$name_CheckAnonymousGrading" name="$name_CheckAnonymousGrading" type="checkbox" value="true"
			#if ($value_CheckAnonymousGrading.equals("true"))
				checked="checked"
			#end
			#if( !$enableAnonGrading )
				disabled="disabled"
			#end
			/>
			$tlang.getString("grading.anonymous")
		</label>
	</div>
#end ## $fragment_anonymous

#define($fragment_grade_scale)
	<div class="form-group row form-required">
		<label for="$name_GradeType" class="col-sm-2 control-label owlIndent1">$tlang.getString("gen.grasca")</label>
		<div id="gradeScaleSelectContainer" class="col-sm-6">
			<span class="skip">$tlang.getString("newassig.selectmessage")</span>
			<select id="$name_GradeType"  name="$name_GradeType" title="$tlang.getString("gen.grasca")" onchange="ASN.handleGradeScaleChange(this, '$name_GradePoints', '$!gradebookChoice_add', '$!gradebookChoice_associate')">
				<option value="3" #if (1 == $value_GradeType || 3 == $value_GradeType)selected="selected"#end>$gradeTypeTable.get(3)</option>
				<option value="2" #if (2 == $value_GradeType)selected="selected"#end>$gradeTypeTable.get(2)</option>
				<option value="4" #if (4 == $value_GradeType)selected="selected"#end>$gradeTypeTable.get(4)</option>
				<option value="5" #if (5 == $value_GradeType)selected="selected"#end>$gradeTypeTable.get(5)</option>
			</select>
		</div>
	</div>
#end ## $fragment_grade_scale

#define($fragment_grade_points)
	## enable the maxfield when it is points grade type
	<div class="form-group row form-required">
		<label for="$name_GradePoints" class="col-sm-1 control-label owlIndent2">$tlang.getString("gen.forpoi")</label>
		<div class="col-sm-2">
			<input name="$name_GradePoints" id="$name_GradePoints" value="$!value_GradePoints" type="text" size="5" maxlength="11" class="form-control" />
		</div>
	</div>
#end ## $fragment_grade_points

#define($fragment_gradebook_options_add)
			<div class="radio owlIndent1">  ## Add to Gradebook
				<label id="radioAddToGbLabel" for="$!gradebookChoice_add">
					<input type="radio" name="$!name_Addtogradebook" id="$!gradebookChoice_add" value="$!gradebookChoice_add"
						#if($!gradebookChoice.equals("$!gradebookChoice_add"))checked#end
						onclick="ASN.handleGradebookRadioClick(this, '$!gradebookChoice_add');" >
					$tlang.getString("grading.add")
				</label>
			</div>
			#if ($!value_totalCategories > 1)
			## show the "Category list" choices or not
			<div id="categoryList" class="owlIndent2">
				<label for="category">$tlang.getString("grading.categorylist")</label>
				<select name="$name_Category" id="category" #if(!$!gradebookChoice.equals("$!gradebookChoice_add"))disabled#end>
					#foreach ($i in $categoryKeys)
						<option value="$i" #if ($i == $!value_Category)selected="selected"#end>$categoryTable.get($i)</option>
					#end
				</select>
			</div>
			#end
#end ## $fragment_gradebook_options_add

#define($fragment_gradebook_options_associate)
			<div class="radio owlIndent1">  ## Associate with Existing Gradebook Item
				<label id="radioAssocWithGbLabel" for="$!gradebookChoice_associate">
					<input type="radio"	name="$!name_Addtogradebook" id="$!gradebookChoice_associate" value="$!gradebookChoice_associate"
						#if($!gradebookChoice.equals("$!gradebookChoice_associate"))checked#end
						onclick="ASN.handleGradebookRadioClick(this, '$!gradebookChoice_add');" >
					$tlang.getString("grading.associate")
				</label>
			</div>
			<div id="gradebookList" class="owlIndent2">
				<select name="$!name_AssociateGradebookAssignment" id="gradebookItemSelect">
					<option value="">$tlang.getString("grading.select")</option>
					#set($gAssignmentSet = $!gradebookAssignmentsLabel.keySet())
					#foreach ($gaId in $!gAssignmentSet.iterator())
						<option  value="$gaId"
							#if($!gradebookAssignmentsSelectedDisabled.get($gaId).equals("disabled"))
								disabled="disabled"
							#elseif($!gradebookAssignmentsSelectedDisabled.get($gaId).equals("selected"))
								selected="selected"
							#end>
								$validator.escapeHtml($!gradebookAssignmentsLabel.get($gaId))
						</option>
					#end
				</select>
			</div>
#end ## $fragment_gradebook_options_associate

#define($fragment_gradebook_options)
	## show the "Add to Gradebook" choices or not
	#if(!$!allowGroupAssignmentsInGradebook)
		#set ($addToGBDisplay="none")
	#else
		#set ($addToGBDisplay="block")
	#end
	#set($sendToGradebook=false)
	#if($!gradebookChoice.equals("$!gradebookChoice_add") || $!gradebookChoice.equals("$!gradebookChoice_associate"))
		#set($sendToGradebook=true)
	#end
	<div class="form-group row" style="display:$!addToGBDisplay">
		<div class="col-sm-10 owlIndent2" style="display:$!addToGBDisplay">
			<div class="checkbox">  ## Send to Gradebook
				<label for="$name_SendToGradebook">
					<input type="checkbox" id="$name_SendToGradebook" name="$name_SendToGradebook" value="true"
						#if($sendToGradebook)checked#end
						onclick="ASN.handleSendToGradebookClick(this, '$!gradebookChoice_add', '$!gradebookChoice_associate' );" >
					$tlang.getString("grading.send")
				</label>
			</div>
			<div id="assignmentGradingGradebookOptionsPanel" #if(!$sendToGradebook)style="display: none;"#end>
				#if (!$!noAddToGradebookChoice)
				$fragment_gradebook_options_add
				#end

				## if there are assignment entries in Gradebook
				#if (!$!gradebookAssignmentsLabel.isEmpty())
				$fragment_gradebook_options_associate
				#end
			</div>
		</div>
	</div>
#end ## $fragment_gradebook_options

#define($fragment_peer_assessment)
	#set($groupAssignment = false)
	#if ($!range == "groupAssignment" && $!groupsList && !$selectedGroupsNotFound)
		#set($groupAssignment = true)
	#end
	<div class="peerAssessmentContainer form-group row">
		<div class="checkbox col-sm-12 owlIndent2">
			<label id="peerAssessmentCheckboxLabel" for="usePeerAssessment">
				<input id="usePeerAssessment" name="$name_UsePeerAssessment" type="checkbox" value="true"
					#if ($!value_UsePeerAssessment.equals("true")) checked="checked" #end
					#if ($groupAssignment) disabled="disabled" #end
					onclick="ASN.togglePeerAssessment(this)"
				/>
				$tlang.getString("peerAssessmentUse")
				<span id="peerGroupAsnWarn" style="display:#if($groupAssignment)block#else none#end;">
					$tlang.getString("peerassessment.warn.nogroup")
				</span>
			</label>
		</div>
			#set($displayPeerOptions = "none")
			#if($!value_UsePeerAssessment.equals("true"))
				#set($displayPeerOptions = "block")
			#end
			<div id="peerAssessmentOptions" class="col-sm-offset-1" style="display:$displayPeerOptions">

			<div id="peerperiod-finish">
				$tlang.getString("peerassessment.periodfinishes")
				<input type="text" id="new_assignment_peerperiod" name="new_assignment_peerperiod" class="datepicker" value="">
			</div>

				<script type="text/javascript">
					  localDatePicker({
						input:'#new_assignment_peerperiod',
						useTime:1,
						val:"$value_PeerPeriodYear$H$value_PeerPeriodMonth$H$value_PeerPeriodDay $value_PeerPeriodHour:$value_PeerPeriodMin",
						parseFormat: 'YYYY-MM-DD HH:mm',
						ashidden:{
							month:"$name_PeerPeriodMonth",
							day:"$name_PeerPeriodDay",
							year:"$name_PeerPeriodYear",
							hour:"$name_PeerPeriodHour",
							minute:"$name_PeerPeriodMin"
						}
					  });
				</script>
			##Anonymous Eval
			#if ($!value_PeerAssessmentAnonEval.equals("true"))
				<input id="$name_PeerAssessmentAnonEval" name="$name_PeerAssessmentAnonEval" type="checkbox" value="true" checked="checked"/>
			#else
				<input id="$name_PeerAssessmentAnonEval" name="$name_PeerAssessmentAnonEval" type="checkbox" value="true"/>
			#end
			<label for="$name_PeerAssessmentAnonEval">
				$tlang.getString("peerassessment.anonymousEvaluation")
			</label>
			<br/>
			##Students View Reviews
			#if ($!value_PeerAssessmentStudentViewReviews.equals("true"))
				<input id="$name_PeerAssessmentStudentViewReviews" name="$name_PeerAssessmentStudentViewReviews" type="checkbox" value="true" checked="checked"/>
			#else
				<input id="$name_PeerAssessmentStudentViewReviews" name="$name_PeerAssessmentStudentViewReviews" type="checkbox" value="true"/>
			#end
			<label for="$name_PeerAssessmentStudentViewReviews">
				$tlang.getString("peerassessment.studentViewReviews")
			</label>
			<br/>
			##Number of Submissions for review
			<span class="reqStar">*</span>
			<input name="$name_PeerAssessmentNumReviews" id="$name_PeerAssessmentNumReviews" value="$!value_PeerAssessmentNumReviews" type="text" size="5" maxlength="11"/>
			<label for="$name_PeerAssessmentNumReviews">
				$tlang.getString("peerassessment.numSubmissions")
			</label>
			<br/>
			<br/>
			$tlang.getString("peerassessment.reviewInstructions")
			<br/>
			<table border="0" style="margin:0"><tr><td>
				<textarea name="$name_PeerAssessmentInstructions" id="$name_PeerAssessmentInstructions" cols="80" rows="30" wrap="virtual">$validator.escapeHtmlTextarea($!value_PeerAssessmentInstructions)</textarea>
				#chef_setupformattedtextarea($name_PeerAssessmentInstructions)
			</td</tr></table>
		</div>
	</div>
#end ## $fragment_peer_assessment

## ---------- Section Skeleton ------------------

## Header
#if( ($!withGrade && $!withGradebook) || ($enableAnonGrading || $value_CheckAnonymousGrading.equals("true")) )
	<h4>$!tlang.getString('grading')</h4>
#end

## Anonymous Grading (SAK-17606)
#if( $enableAnonGrading || $value_CheckAnonymousGrading.equals("true") )
$fragment_anonymous
#end

## Grading Options
#if ($withGrade)
	<div class="checkbox">
		<label for="gradeAssignment">
			<input id="gradeAssignment" name="$name_GradeAssignment" type="checkbox" value="true" #if($value_GradeType != 1)checked#end
				onclick="ASN.handleGradeAssignmentClick(this, '$name_GradeType', '$name_GradePoints');">
			$tlang.getString("grading.gradeAssignment")
		</label>
	</div>

	<div id="assignmentGradingPanel"#if($value_GradeType == 1)style="display:none;"#end >
		$fragment_grade_scale
		<div id="assignmentGradingPointsPanel" #if($value_GradeType != 3 && $value_GradeType != 1)style="display:none;"#end >
			$fragment_grade_points
			#if ($!withGrade && $!withGradebook)
			$fragment_gradebook_options
			#end
			#if ($allowPeerAssessment)
			$fragment_peer_assessment
			#end
		</div>
	</div>
#end


